<!DOCTYPE html>
<html lang="id" class="notranslate">
    <head>
        <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css">
        <script defer src="https://pyscript.net/alpha/pyscript.js"></script>

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous" />

        <style>
        body {
            background-color: #fcfcfc;
            padding-top: 55px;
            min-height: 100vh;
            margin:0;
            display:flex;
            flex-direction:column;
          }
        </style>  
    </head>
    <body>
        <div class="container">
            <center>
                <h2>CONTEXT FREE GRAMMAR</h2>
            </center>
            <p>Kata-kata yang diterima mesin adalah sebagai berikut:</p>
            <p>Kata benda: siwur | jukut | kai | cai | bumi</p>
            <p>Kata kerja: maca | teuleug | mioh | bayur | tuang</p>
            <input id="kalimat" type="text", class="form-control" aria-label="Large" aria-describedby="inputGroup-sizing-sm" placeholder="Masukkan kalimat Anda di sini">
            <center>
                <button id="idButton" type="submit" class="btn btn-info" pys-onClick="lexicalAnalizer">submit</button>
            </center>
    
            <textarea id="kalimatBaru" cols="30" rows="10" disabled rows="2" aria-label="Large" aria-describedby="inputGroup-sizing-sm" placeholder="Result"></textarea>

            <h3>Anggota tim</h3>
            <p>Aryya Bagus Padmanawijaya (1301204310)</p>
            <p>Hana Amani Fatihah (1301204252)</p>
            <p>Nadia Khairunissa (1301204167)</p>

            <br>
            <a href="https://github.com/aryyawijaya/CFG-machine">Link Project</a>
        </div>
        <py-script>
            from js import document

            # Import Library
            import string

            def lexicalAnalizer(*args, **kwargs):
                console.log('test')
                # Initialization
                alphabetList = list(string.ascii_lowercase)
                stateList = [
                            'q0', 'q1', 'q2', 'q3', 'q4', 'q5', 'q6', 'q7', 'q8', 'q9',
                            'q10', 'q11', 'q12', 'q13', 'q14', 'q15', 'q16', 'q17', 'q18', 'q19',
                            'q20', 'q21', 'q22', 'q23', 'q24', 'q25', 'q26', 'q27', 'q28', 'q29',
                            'q30', 'q31', 'q32', 'q33', 'q34', 'q35'
                            ]
                
                transitionTable = {}
                
                for state in stateList:
                    for alphabet in alphabetList:
                        transitionTable[(state, alphabet)] = 'error'
                    transitionTable[(state, '#')] = 'error'
                    transitionTable[(state, ' ')] = 'error'
                
                transitionTable['q0', ' '] = 'q0'
                
                # siwur
                transitionTable[('q0', 's')] = 'q17'
                transitionTable[('q17', 'i')] = 'q18'
                transitionTable[('q18', 'w')] = 'q19'
                transitionTable[('q19', 'u')] = 'q20'
                transitionTable[('q20', 'r')] = 'q21'
                transitionTable[('q21', ' ')] = 'q35'
                transitionTable[('q21', '#')] = 'accept'
                transitionTable[('q35', ' ')] = 'q35'
                transitionTable[('q35', '#')] = 'accept'
                
                ## transition for new token
                transitionTable[('q35', 's')] = 'q17'
                
                # jukut - hana
                transitionTable[('q0', 'j')] = 'q27'
                transitionTable[('q27', 'u')] = 'q28'
                transitionTable[('q28', 'k')] = 'q29'
                transitionTable[('q29', 'u')] = 'q30'
                transitionTable[('q30', 't')] = 'q31'
                transitionTable[('q31', ' ')] = 'q35'
                transitionTable[('q31', '#')] = 'accept'
                transitionTable[('q35', ' ')] = 'q35'
                transitionTable[('q35', '#')] = 'accept'
                
                ## transition for new token
                transitionTable[('q35', 'j')] = 'q27'
                
                # kai - nadia
                transitionTable[('q0','k')] = 'q32'
                transitionTable[('q32','a')] = 'q33'
                transitionTable[('q33','i')] = 'q34'
                transitionTable[('q34',' ')] = 'q35'
                transitionTable[('q34', '#')] = 'accept'
                transitionTable[('q35', ' ')] = 'q35'
                transitionTable[('q35', '#')] = 'accept'
                
                ## transition for new token
                transitionTable[('q35', 'k')] = 'q32'
                
                # cai - aryya
                transitionTable[('q0', 'c')] = 'q32'
                
                ## transition for new token
                transitionTable[('q35', 'c')] = 'q32'
                
                # bumi
                transitionTable[('q0', 'b')] = 'q22'
                transitionTable[('q22', 'u')] = 'q24'
                transitionTable[('q24', 'm')] = 'q25'
                transitionTable[('q25', 'i')] = 'q26'
                transitionTable[('q26', ' ')] = 'q35'
                transitionTable[('q26', '#')] = 'accept'
                transitionTable[('q35', ' ')] = 'q35'
                transitionTable[('q35', '#')] = 'accept'
                
                ## transition for new token
                transitionTable[('q35', 'b')] = 'q22'
                
                # maca
                transitionTable[('q0', 'm')] = 'q13'
                transitionTable[('q13','a')] = 'q14'
                transitionTable[('q14','c')] = 'q15'
                transitionTable[('q15','a')] = 'q16'
                transitionTable[('q16',' ')] = 'q35'
                transitionTable[('q16','#')] = 'accept'
                transitionTable[('q35',' ')] = 'q35'
                transitionTable[('q35','#')] = 'accept'
                
                ## transition for new token
                transitionTable[('q35', 'm')] = 'q13'
                
                # teuleug
                transitionTable[('q0', 't')] = 'q6'
                transitionTable[('q6', 'e')] = 'q7'
                transitionTable[('q7', 'u')] = 'q8'
                transitionTable[('q8', 'l')] = 'q9'
                transitionTable[('q9', 'e')] = 'q10'
                transitionTable[('q10', 'u')] = 'q11'
                transitionTable[('q11', 'g')] = 'q12'
                transitionTable[('q12', ' ')] = 'q35'
                transitionTable[('q12', '#')] = 'accept'
                transitionTable[('q35', ' ')] = 'q35'
                transitionTable[('q35', '#')] = 'accept'
                
                ## transaction for new token
                transitionTable[('q35', 't')] = 'q6'
                
                # mioh
                transitionTable[('q13', 'i')] = 'q3'
                transitionTable[('q3', 'o')] = 'q4'
                transitionTable[('q4', 'h')] = 'q5'
                transitionTable[('q5', ' ')] = 'q35'
                transitionTable[('q5', '#')] = 'accept'
                transitionTable[('q35', ' ')] = 'q35'
                transitionTable[('q35', '#')] = 'accept'
                
                # bayur
                transitionTable[('q0', 'b')] = 'q22'
                transitionTable[('q22', 'a')] = 'q23'
                transitionTable[('q23', 'y')] = 'q19'
                transitionTable[('q19', 'u')] = 'q20'
                transitionTable[('q20', 'r')] = 'q21'
                transitionTable[('q21', ' ')] = 'q35'
                transitionTable[('q21', '#')] = 'accept'
                transitionTable[('q35', ' ')] = 'q35'
                transitionTable[('q35', '#')] = 'accept'
                
                # tuang
                transitionTable[('q6', 'u')] = 'q1'
                transitionTable[('q1', 'a')] = 'q2'
                transitionTable[('q2', 'n')] = 'q11'
                transitionTable[('q25', 'a')] = 'q19'
                
                # Lexical Analysis
                def lexAn(sentence, inputString):
                    idxChar = 0
                    state = 'q0'
                    currentToken = ''
                    acceptedState = ['q5', 'q12', 'q16', 'q21', 'q26', 'q31', 'q34']
                    while state != 'accept':
                        currentChar = inputString[idxChar]
                        currentToken += currentChar
                        state = transitionTable[(state, currentChar)]
                        if state in acceptedState:
                            <!-- print('current token:', currentToken, 'valid') -->
                            log = 'current token:', currentToken, 'valid'
                            pyscript.write("kalimatBaru", log)
                            currentToken = ''
                        elif state == 'error':
                            <!-- print('error') -->
                            pyscript.write("kalimatBaru", 'error')
                            break;
                        idxChar += 1
                    if state == 'accept':
                        <!-- print('semua token diinput:', sentence, 'valid') -->
                        log = 'semua token diinput:', sentence, 'valid'
                        pyscript.write("kalimatBaru", log)
                
                # input user
                sentence = document.getElementById('kalimat').value
                inputString = sentence.lower() + '#'
                lexAn(sentence, inputString)
        </py-script>
    </body>
</html>